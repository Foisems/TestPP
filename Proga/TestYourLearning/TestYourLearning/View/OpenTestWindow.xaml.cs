using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;
using TestYourLearning.Model;

namespace TestYourLearning.View
{
    /// <summary>
    /// Логика взаимодействия для OpenTestWindow.xaml
    /// </summary>
    public partial class OpenTestWindow : Window
    {
        private Test test = new Test();
        private int count = 0;
        private int idUser = 0;

        public OpenTestWindow(Test Test, int IdUser)
        {
            InitializeComponent();

            test = Test;
            idUser = IdUser;

            nameTestTB.Text = "\"" + test.Name + "\"";
            using (TestDBEntities db = new TestDBEntities())
            {
                var questionInTest = db.QuestionInTest.Where(u => u.IdTest == test.Id);
                count = questionInTest.Count();
                countQuestionTB.Text = "Количество вопросов: " + count.ToString();

            }
        }

        // Пройти тест
        private void passTestBtn_Click(object sender, RoutedEventArgs e)
        {
            if(count > 0)
            {
                PassTestWindow passTestWindow = new PassTestWindow(test, count, idUser);
                this.Close();
                passTestWindow.ShowDialog();
            }
            else
            {
                MessageBox.Show("В данном тесте недостаточное количество вопросов", "Ошибка", MessageBoxButton.OK, MessageBoxImage.Error);
            }
        }
    }
}
